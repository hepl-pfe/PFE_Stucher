jQuery(function(e){function t(){var e=document.location.search;"?"==e.charAt(0)&&(e=e.substring(1));for(var t=e.split("&"),r=new Object,n=0;n<t.length;n++){var o=t[n].split("=");r[o[0]]=o[1]}return r}if(e("#dtBox").DateTimePicker({language:"fr",dateTimeFormat:"dd-MM-yyyy HH:mm",dateFormat:"dd-MM-yyyy",timeFormat:"HH:mm",shortDayNames:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],fullDayNames:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],shortMonthNames:["jan","fév","mar","avr","mai","jun","jul","aoû","sep","oct","nov","déc"],fullMonthNames:["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],titleContentDate:"Choisir une date",titleContentTime:"Choisir un horaire",titleContentDateTime:"Choisir une date et un horaire",setButtonContent:"Choisir",clearButtonContent:"Effacer",formatHumanDate:function(e,t,r){return"date"===t?e.dayShort+" "+e.dd+" "+e.month+" "+e.yyyy:"time"===t?e.HH+":"+e.mm:"datetime"===t?e.dayShort+" "+e.dd+" "+e.month+" "+e.yyyy+", "+e.HH+":"+e.mm:void 0},minuteInterval:10,buttonsToDisplay:["HeaderCloseButton","SetButton"],setValueInTextboxOnEveryClick:!0}),e("#course_seance").removeAttr("disabled"),e("#course_seance").change(function(){var t=document.getElementById("course_seance"),r=document.getElementById("course_seance").selectedIndex,n=t[r].value,o={"01":"January","02":"February","03":"March","04":"April","05":"May","06":"June","07":"July","08":"August","09":"September",10:"October",11:"November",12:"December"},s={"01":"janvier","02":"février","03":"mars","04":"avril","05":"mai","06":"juin","07":"juillet","08":"aout","09":"septembre",10:"octobre",11:"novembre",12:"décembre"},i=["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"];e.get("/course/"+n+"/seances/ajax",function(t){e("#seance").children().remove();for(var r=0;r<t.length;r++){var n=(t[r].start_hours,t[r].start_hours.substring(0,4)),u=t[r].start_hours.substring(5,7),a=t[r].start_hours.substring(8,10),c=t[r].start_hours.substring(11,13),l=t[r].end_hours.substring(11,13),p=t[r].start_hours.substring(14,16),m=t[r].end_hours.substring(14,16),d=new Date(o[u]+" "+a+", "+n+" "+c+":"+p+":00"),f=d.getDay();e("#seance").append('<option value="'+t[r].id+'">'+i[f]+" "+a+" "+s[u]+" "+n+" de "+c+"h"+p+" à "+l+"h"+m+"</option>"),e("#seance").fadeIn()}0==t.length&&(e("#seance").append('<option value="">Aucune séance</option>'),e("#seance").fadeIn())})}),e(".pageContainer").click(function(t){1==e("#menuToggle")[0].checked&&(e("#menuToggle")[0].checked=!1),void 0!=e("#dd_moreButton")[0]&&(1==e("#dd_moreButton")[0].checked&&(e(".menuToggle").click(function(){e("#dd_moreButton")[0].checked=!1}),"dd_moreButton"!=t.target.parentNode.className&&(e("#dd_moreButton")[0].checked=!1)),0==e("#dd_moreButton")[0].checked&&"dd_moreButton--button"==t.target.className)}),e(".shutterTitle--works, .shutterTitle--tests").addClass("reduce"),window.location.hash){var r=window.location.hash.substring(1);e("#"+r).toggleClass("reduce")}e(".shutterTitle--comments").removeClass("reduce"),e(".shutterTitle").click(function(t){e(t.target).toggleClass("reduce")}),e(".shutterTitle span").click(function(t){e(t.target.parentNode).toggleClass("reduce")}),e(".comment__box--textarea").keypress(function(t){t.shiftKey||13==t.keyCode&&(t.preventDefault(),e(this).parents("form").submit())}),e(".changedFile input").addClass("hidden"),e(".changedFile input").change(function(t){var r=t.currentTarget.files.length;e(".changedFile .fileRightText--1").text(r+" Fichier(s)").addClass("fileRightText--alone"),e(".changedFile .fileRightText--2").remove()}),e(".deleteFile").click(function(t){t.preventDefault();var r=t.currentTarget.href+"/ajax",n=e(this).parent();e.ajax({type:"GET",url:r,success:function(){n.fadeOut("slow",function(){e(this).remove()})}})}),e(".comment__icon--delete").click(function(t){t.preventDefault();var r=t.currentTarget.href+"/ajax",n=e(this).parent();e.ajax({type:"GET",url:r,success:function(){n.fadeOut("slow",function(){e(this).remove(),$shutterNumber=e(".shutterTitle--comments--number").text(),e(".shutterTitle--comments--number").text(parseInt($shutterNumber)-1)})}})}),e(".deleteButtonBg").click(function(t){t.preventDefault();var r=t.currentTarget.href+"/ajax",n=e(this).parent().parent();e.ajax({type:"GET",url:r,success:function(){n.fadeOut("slow",function(){e(this).remove()})}})}),e(function(){e('a[href*="#"]:not([href="#"])').click(function(){if(location.pathname.replace(/^\//,"")==this.pathname.replace(/^\//,"")&&location.hostname==this.hostname){var t=e(this.hash);if(t=t.length?t:e("[name="+this.hash.slice(1)+"]"),t.length)return e("html, body").animate({scrollTop:t.offset().top},1e3),!1}})}),e(".icon--closeErrorMessage").click(function(t){e(this).parent().fadeOut("slow",function(){e(this).remove()})}),e(".notification__button--archive").click(function(t){t.preventDefault();var r=t.currentTarget.href+"/ajax",n=e(this).parent().parent();e.ajax({type:"GET",url:r,success:function(){n.fadeOut("slow",function(){e(this).remove()})}})}),e(".action__deleteCourse").click(function(t){t.preventDefault();var r=t.currentTarget.href;swal({title:"Supprimer ce cours?",text:"En supprimant ce cours, vous supprimerez tous les éléments liés à celui-ci (séances, interrogations, devoir, fichiers etc.)",showCancelButton:!0,closeOnConfirm:!1,confirmButtonText:"Oui, je supprime",cancelButtonText:"Non",confirmButtonColor:"#ec6c62"},function(){e.ajax({type:"get",url:r}).done(function(e){swal({title:"Supprimé!",text:"Le cours a correctement été supprimé!",type:"success"},function(){window.location.href="/"})}).error(function(e){swal("Oops","Une erreur s'est produite sur le serveur!","error")})})}),e(".action__removeCourse").click(function(t){t.preventDefault();var r=t.currentTarget.href;swal({title:"Quitter ce cours?",text:"En quittant ce cours, vous n’aurez plus accès à ses séances, interrogations, devoir, fichiers etc.",showCancelButton:!0,closeOnConfirm:!1,confirmButtonText:"Oui, je quitte",cancelButtonText:"Non",confirmButtonColor:"#ec6c62"},function(){e.ajax({type:"get",url:r}).done(function(e){swal({title:"Quitté!",text:"Vous n’avez plus accès au cours",type:"success"},function(){window.location.href="/"})}).error(function(e){swal("Oops","Une erreur s'est produite sur le serveur!","error")})})}),e(".action__deleteProfil").click(function(t){t.preventDefault();var r=t.currentTarget.href;swal({title:"Supprimer votre compte?",text:"En supprimant votre compte, vous supprimerez tous les éléments liés à celui-ci (cours, séances, interrogations, devoir, fichiers etc.)",showCancelButton:!0,closeOnConfirm:!1,confirmButtonText:"Oui, je supprime",cancelButtonText:"Non",confirmButtonColor:"#ec6c62"},function(){e.ajax({type:"get",url:r}).done(function(e){swal({title:"Supprimé!",text:"Votre compte a correctement été supprimé!",type:"success"},function(){window.location.href="/"})}).error(function(e){swal("Oops","Une erreur s'est produite sur le serveur!","error")})})}),e(".action__deleteSeance").click(function(t){t.preventDefault();var r=t.currentTarget.href,n=t.currentTarget.getAttribute("data-page");if("seance"==n)var o=t.currentTarget.getAttribute("data-course");else var s=e(this).parent().parent().parent().parent().parent();swal({title:"Supprimer Cette séance?",text:"En supprimant cette séance, vous supprimerez tous les éléments liés à celle-ci (interrogations, devoir, fichiers etc.)",showCancelButton:!0,closeOnConfirm:!1,confirmButtonText:"Oui, je supprime",cancelButtonText:"Non",confirmButtonColor:"#ec6c62"},function(){e.ajax({type:"get",url:r}).done(function(t){swal({title:"Supprimé!",text:"La séance a correctement été supprimée!",type:"success"},function(){"seance"==n?window.location.href="/course/"+o+"/view":s.fadeOut("slow",function(){e(this).remove()})})}).error(function(e){swal("Oops","Une erreur s'est produite sur le serveur!","error")})})}),e(".action__deleteWork").click(function(t){t.preventDefault();var r=t.currentTarget.href+"/ajax";t.currentTarget.getAttribute("data-seance");swal({title:"Supprimer ce devoir?",text:"En supprimant ce devoir, vous supprimerez tous les fichiers liés à celui-ci",showCancelButton:!0,closeOnConfirm:!1,confirmButtonText:"Oui, je supprime",cancelButtonText:"Non",confirmButtonColor:"#ec6c62"},function(){e.ajax({type:"get",url:r}).done(function(r){swal({title:"Supprimé!",text:"Le devoir a correctement été supprimé!",type:"success"},function(){t.target.parentNode.parentNode.parentNode.remove(),$shutterNumber=e(".shutterTitle--works--number").text(),e(".shutterTitle--works--number").text(parseInt($shutterNumber)-1)})}).error(function(e){swal("Oops","Une erreur s'est produite sur le serveur!","error")})})}),e(".action__deleteTest").click(function(t){t.preventDefault();var r=t.currentTarget.href+"/ajax";t.currentTarget.getAttribute("data-seance");swal({title:"Supprimer cette interrogation?",text:"En supprimant cette interrogation, vous supprimerez tous les fichiers liés à celle-ci",showCancelButton:!0,closeOnConfirm:!1,confirmButtonText:"Oui, je supprime",cancelButtonText:"Non",confirmButtonColor:"#ec6c62"},function(){e.ajax({type:"get",url:r}).done(function(r){swal({title:"Supprimé!",text:"L’interrogation a correctement été supprimée!",type:"success"},function(){t.target.parentNode.parentNode.parentNode.remove(),$shutterNumber=e(".shutterTitle--tests--number").text(),e(".shutterTitle--tests--number").text(parseInt($shutterNumber)-1)})}).error(function(e){swal("Oops","Une erreur s'est produite sur le serveur!","error")})})}),qs=t(),qs.popupError&&("teacher"==qs.popupError&&swal("Oops...","Il faut être professeur pour faire ça!","error"),"userAccess"==qs.popupError&&swal("Oops...","Vous n’avez pas les droits nécéssaire pour vous rendre là!","error"),"logout"==qs.popupError&&swal("Oops...","Vous devez être connecté pour vous rendre là!","error"),"notCourse"==qs.popupError&&swal("Oops...","Ce cours n’existe pas!","error"),"notSeance"==qs.popupError&&swal("Oops...","Cette séance n’existe pas!","error"),"notWork"==qs.popupError&&swal("Oops...","Ce devoir n’existe pas!","error"),"notTest"==qs.popupError&&swal("Oops...","Cette interrogation n’existe pas!","error"),"notComment"==qs.popupError&&swal("Oops...","Ce commentaire n’existe pas!","error"),"commentAccess"==qs.popupError&&swal("Oops...","Vous n’avez pas les droits nécéssaire supprimer ce commentaire!","error"))});
